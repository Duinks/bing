import{u as b,a as w}from"./bing.cf5c1442.js";import{d as M,i as B,a as I,j as T,L as F,r as A,o as c,e as i,l,t as g,m,F as E,M as N,g as H,N as $}from"./index.7b144718.js";const D={key:0,class:"info-text is-refreshing"},O=["onClick"],V={key:1,class:"info-text is-loading-more"},j={key:2,class:"info-text is-no-more"},z=M({__name:"image-list",props:{showInfoText:{type:Boolean,default:!0},autoLoad:{type:[Boolean,Number],default:!0}},emits:["click-image"],setup(_,{emit:k}){const s=_,n=b(),{t:u}=w(),a=B({loadStatus:{},loadCount:0}),h=I(),p=(o,t=100)=>{let r=null;return()=>{r&&clearTimeout(r),r=setTimeout(()=>{o.apply(this)},t)}},d=p(()=>{if(n.noMore)return;const o=100,t=document.body.clientHeight||document.documentElement.clientHeight,r=h.value.getBoundingClientRect();(s.autoLoad===!0||typeof s.autoLoad=="number"&&a.loadCount<s.autoLoad)&&r.bottom-o<t&&!n.loadingMore&&(p(n.loadMore)(),a.loadCount++)});d();const v=()=>{window.addEventListener("scroll",d,!0)};T(()=>{s.autoLoad&&v()}),F(()=>{window.removeEventListener("scroll",d,!0)});const S=(o,t)=>{a.loadStatus[t]={status:!1,next:o},t===0&&o(),a.loadStatus[t-1]&&a.loadStatus[t-1].status===!0&&o()},y=o=>{a.loadStatus[o].status=!0,a.loadStatus[o+1]&&a.loadStatus[o+1].next()},C=o=>{k("click-image",o)};return(o,t)=>{const r=A("pmage");return c(),i("div",{ref_key:"imageList",ref:h,class:"image-list"},[s.showInfoText&&l(n).refreshing?(c(),i("div",D,g(l(u)("notice.refreshing")),1)):m("",!0),(c(!0),i(E,null,N(l(n).dataList,(e,L)=>(c(),i("div",{key:e==null?void 0:e.id,class:"image-item",onClick:f=>C(e)},[H(r,{placeholder:e==null?void 0:e.base64,src:e==null?void 0:e.url.thumbnail,class:"image",onBeforeLoad:f=>S(f,L),onOnload:f=>y(L)},null,8,["placeholder","src","onBeforeLoad","onOnload"]),$(o.$slots,"content",{data:e})],8,O))),128)),s.showInfoText&&l(n).loadingMore?(c(),i("div",V,g(l(u)("notice.loadingMore")),1)):m("",!0),s.showInfoText&&l(n).noMore?(c(),i("div",j,g(l(u)("notice.noMore")),1)):m("",!0)],512)}}});export{z as _};
